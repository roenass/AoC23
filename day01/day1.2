#! /usr/bin/env ruby -an

BEGIN {$sum=0}
END {puts "Calibration value: #{$sum}"}

$prefix=""
$rest=$_
while $rest.match(/....*$/)
    $rest = $rest.gsub(/^one/,"1e")
    $rest = $rest.gsub(/^two/,"2o")
    $rest = $rest.gsub(/^three/,"3e")
    $rest = $rest.gsub(/^four/,"4r")
    $rest = $rest.gsub(/^five/,"5e")
    $rest = $rest.gsub(/^six/,"6x")
    $rest = $rest.gsub(/^seven/,"7n")
    $rest = $rest.gsub(/^eight/,"8t")
    $rest = $rest.gsub(/^nine/,"9n")
    $first = $rest.match(/^(.)/)[1]
    $prefix += $rest.match(/^(.)/)[1]
    $rest = $rest.match(/^.(.*)$/)[1]
end
$_ = $prefix + $rest

$first = $_.match(/[^0-9]*([0-9]).*$/)[1]
$last  = $_.match(/.*([0-9])[^0-9]*$/)[1]

$sum += ($first+$last).to_i
